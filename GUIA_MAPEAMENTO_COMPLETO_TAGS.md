# ğŸ“‹ GUIA COMPLETO: Mapeamento de VariÃ¡veis nas Tags

## âœ… **VARIÃVEIS JÃ CRIADAS**

VocÃª jÃ¡ criou todas as variÃ¡veis necessÃ¡rias! Agora sÃ³ precisa mapear nas tags.

---

## ğŸ¯ **MAPEAMENTO POR TAG**

### **1. FB - ViewContent**

#### **Custom Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `currency` | `{{ed - currency}}` | `currency` (nÃ­vel raiz) âœ… |
| `value` | `{{ed - value}}` | `value` (nÃ­vel raiz) âœ… |
| `content_ids` | `{{ed - content_ids}}` | `content_ids` âœ… |
| `contents` | `{{ed - contents}}` | `contents` âœ… |
| `content_name` | `{{ed - content_name}}` | `content_name` âš ï¸ (pode nÃ£o chegar) |
| `content_type` | `{{ed - content_type}}` | `content_type` âš ï¸ (pode nÃ£o chegar) |
| `num_items` | `{{ed - num_items}}` | `num_items` âœ… |

#### **User Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Email` | `{{ed - email_address}}` | `email_address` (nÃ­vel raiz) âœ… |
| `Phone` | `{{ed - phone_number}}` | `phone_number` (nÃ­vel raiz) âœ… |
| `First Name` | `{{ed - first_name}}` | `first_name` (nÃ­vel raiz) âœ… |
| `Last Name` | `{{ed - last_name}}` | `last_name` (nÃ­vel raiz) âœ… |
| `City` | `{{ed - city}}` | `city` (nÃ­vel raiz) âœ… |
| `State` | `{{ed - region}}` | `region` (nÃ­vel raiz) âœ… |
| `Country` | `{{ed - country}}` | `country` (nÃ­vel raiz) âœ… |
| `Zip` | `{{ed - postal_code}}` | `postal_code` (nÃ­vel raiz) âœ… |
| `External ID` | `{{ed - user_id}}` | `user_id` (nÃ­vel raiz) âœ… |

#### **Event ID:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Event ID` | `{{ed - event_id}}` | `event_id` âœ… |

---

### **2. FB - AddToCart**

#### **Custom Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `currency` | `{{ed - currency}}` | `currency` (nÃ­vel raiz) âœ… |
| `value` | `{{ed - value}}` | `value` (nÃ­vel raiz) âœ… |
| `content_ids` | `{{ed - content_ids}}` | `content_ids` âœ… |
| `contents` | `{{ed - contents}}` | `contents` âœ… |
| `content_name` | `{{ed - content_name}}` | `content_name` âš ï¸ (pode nÃ£o chegar) |
| `content_type` | `{{ed - content_type}}` | `content_type` âš ï¸ (pode nÃ£o chegar) |
| `num_items` | `{{ed - num_items}}` | `num_items` âœ… |

#### **User Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Email` | `{{ed - email_address}}` | `email_address` (nÃ­vel raiz) âœ… |
| `Phone` | `{{ed - phone_number}}` | `phone_number` (nÃ­vel raiz) âœ… |
| `First Name` | `{{ed - first_name}}` | `first_name` (nÃ­vel raiz) âœ… |
| `Last Name` | `{{ed - last_name}}` | `last_name` (nÃ­vel raiz) âœ… |
| `City` | `{{ed - city}}` | `city` (nÃ­vel raiz) âœ… |
| `State` | `{{ed - region}}` | `region` (nÃ­vel raiz) âœ… |
| `Country` | `{{ed - country}}` | `country` (nÃ­vel raiz) âœ… |
| `Zip` | `{{ed - postal_code}}` | `postal_code` (nÃ­vel raiz) âœ… |
| `External ID` | `{{ed - user_id}}` | `user_id` (nÃ­vel raiz) âœ… |

#### **Event ID:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Event ID` | `{{ed - event_id}}` | `event_id` âœ… |

---

### **3. FB - InitiateCheckout**

#### **Custom Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `currency` | `{{ed - currency}}` | `currency` (nÃ­vel raiz) âœ… |
| `value` | `{{ed - value}}` | `value` (nÃ­vel raiz) âœ… |
| `content_ids` | `{{ed - content_ids}}` | `content_ids` âœ… |
| `contents` | `{{ed - contents}}` | `contents` âœ… |
| `content_name` | `{{ed - content_name}}` | `content_name` âš ï¸ (pode nÃ£o chegar) |
| `content_type` | `{{ed - content_type}}` | `content_type` âš ï¸ (pode nÃ£o chegar) |
| `num_items` | `{{ed - num_items}}` | `num_items` âœ… |

#### **User Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Email` | `{{ed - email_address}}` | `email_address` (nÃ­vel raiz) âœ… |
| `Phone` | `{{ed - phone_number}}` | `phone_number` (nÃ­vel raiz) âœ… |
| `First Name` | `{{ed - first_name}}` | `first_name` (nÃ­vel raiz) âœ… |
| `Last Name` | `{{ed - last_name}}` | `last_name` (nÃ­vel raiz) âœ… |
| `City` | `{{ed - city}}` | `city` (nÃ­vel raiz) âœ… |
| `State` | `{{ed - region}}` | `region` (nÃ­vel raiz) âœ… |
| `Country` | `{{ed - country}}` | `country` (nÃ­vel raiz) âœ… |
| `Zip` | `{{ed - postal_code}}` | `postal_code` (nÃ­vel raiz) âœ… |
| `External ID` | `{{ed - user_id}}` | `user_id` (nÃ­vel raiz) âœ… |

#### **Event ID:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Event ID` | `{{ed - event_id}}` | `event_id` âœ… |

---

### **4. FB - PageView**

#### **Custom Data:**
PageView geralmente nÃ£o precisa de Custom Data (nÃ£o tem `contents` com `item_price`).

Se precisar:
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `content_ids` | `{{ed - content_ids}}` | `content_ids` âœ… |
| `content_name` | `{{ed - content_name}}` | `content_name` âš ï¸ |
| `content_type` | `{{ed - content_type}}` | `content_type` âš ï¸ |

#### **User Data:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Email` | `{{ed - email_address}}` | `email_address` (nÃ­vel raiz) âœ… |
| `Phone` | `{{ed - phone_number}}` | `phone_number` (nÃ­vel raiz) âœ… |
| `First Name` | `{{ed - first_name}}` | `first_name` (nÃ­vel raiz) âœ… |
| `Last Name` | `{{ed - last_name}}` | `last_name` (nÃ­vel raiz) âœ… |
| `City` | `{{ed - city}}` | `city` (nÃ­vel raiz) âœ… |
| `State` | `{{ed - region}}` | `region` (nÃ­vel raiz) âœ… |
| `Country` | `{{ed - country}}` | `country` (nÃ­vel raiz) âœ… |
| `Zip` | `{{ed - postal_code}}` | `postal_code` (nÃ­vel raiz) âœ… |
| `External ID` | `{{ed - user_id}}` | `user_id` (nÃ­vel raiz) âœ… |

#### **Event ID:**
| Campo Meta | VariÃ¡vel GTM | Path |
|------------|--------------|------|
| `Event ID` | `{{ed - event_id}}` | `event_id` âœ… |

---

## âš ï¸ **NOTA SOBRE content_name e content_type**

Esses campos podem nÃ£o chegar no GTM Server-Side (Stape.io pode estar filtrando).

**Se as variÃ¡veis retornarem `undefined`:**
- Usar valores fixos nas tags (nÃ£o ideal, mas funciona)
- Ou investigar configuraÃ§Ã£o do Stape.io

---

## âœ… **RESUMO**

**Use SEMPRE as variÃ¡veis do NÃVEL RAIZ:**
- âœ… `{{ed - currency}}` (nÃ£o `{{ed - ecommerce.currency}}`)
- âœ… `{{ed - value}}` (nÃ£o `{{ed - ecommerce.value}}`)
- âœ… `{{ed - email_address}}` (nÃ£o `{{ed - user_data.email_address}}`)
- âœ… `{{ed - first_name}}` (nÃ£o `{{ed - user_data.first_name}}`)
- âœ… `{{ed - city}}` (nÃ£o `{{ed - user_data.city}}`)

**Por quÃª?**
- Os dados chegam no nÃ­vel raiz âœ…
- As variÃ¡veis do nÃ­vel raiz funcionam âœ…
- As variÃ¡veis nested (`ecommerce.*`, `user_data.*`) retornam `undefined` âŒ

---

**Status:** âœ… **TODAS AS VARIÃVEIS CRIADAS - AGORA SÃ“ MAPEAR NAS TAGS**

